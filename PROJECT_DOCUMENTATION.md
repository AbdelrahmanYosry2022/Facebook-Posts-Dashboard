# شرح شامل لمشروع Facebook Posts Dashboard

بعد قراءة جميع ملفات المشروع، إليك شرح تفصيلي لما يقوم به هذا التطبيق:

## 🏗️ **بنية المشروع**

المشروع مقسم إلى جزأين رئيسيين:

### **1. الواجهة الأمامية (Frontend) - React App**
- **التقنيات المستخدمة**: React 19.1.1 + Vite + CSS
- **الملفات الأساسية**:
  - `src/App.jsx` - المكون الرئيسي للتطبيق
  - `src/main.jsx` - نقطة دخول التطبيق
  - `src/index.css` - الأنماط والتصميم

### **2. الخادم الخلفي (Backend) - Node.js Server**
- **التقنيات المستخدمة**: Express.js + Node.js
- **الملف الرئيسي**: `fb-server/server.cjs`
- **المنفذ**: 4000 (قابل للتغيير)

## 🎯 **الوظائف الأساسية**

### **جلب منشورات فيسبوك**
- يستخدم Facebook Graph API لجلب المنشورات
- يدعم جلب آخر 5 منشورات افتراضياً (قابل للتعديل)
- يجلب معلومات شاملة: النص، الصور، التاريخ، عدد التفاعلات والتعليقات

### **تحليل التفاعلات**
- يعرض إجمالي التفاعلات لكل منشور
- يمكن عرض تفاصيل أنواع التفاعلات (👍 إعجاب، ❤️ حب، 😂 ضحك، إلخ)
- يستخدم نظام Batch Requests لتقليل استهلاك API

### **نظام التخزين المؤقت (Caching)**
- **كاش الخادم**: يستخدم NodeCache لتخزين النتائج لمدة 30 دقيقة
- **كاش المتصفح**: يحفظ البيانات في localStorage لتقليل الطلبات
- يمكن تفريغ الكاش يدوياً عند الحاجة

## 🔧 **الميزات المتقدمة**

### **الفلترة والبحث**
- **فلترة بالتاريخ**: تحديد نطاق زمني للمنشورات
- **فلترة بالصور**: عرض المنشورات التي تحتوي على صور فقط أو بدونها
- **الحد الأدنى للتفاعلات**: عرض المنشورات التي تحتوي على عدد معين من التفاعلات
- **الحد الأدنى للتعليقات**: فلترة حسب عدد التعليقات

### **الترتيب**
- ترتيب حسب التاريخ (الأحدث/الأقدم)
- ترتيب حسب عدد التفاعلات (الأكثر/الأقل)
- ترتيب حسب عدد التعليقات (الأكثر/الأقل)

### **التحديث التلقائي**
- إمكانية تفعيل التحديث التلقائي للبيانات
- تحديد فترة التحديث بالدقائق
- عداد تنازلي يظهر الوقت المتبقي للتحديث القادم

## 📊 **نظام المراقبة (Metrics)**

- **عداد طلبات Facebook API**: يتتبع عدد الطلبات الفعلية لـ Facebook
- **عداد طلبات الخادم**: يتتبع عدد الطلبات من الواجهة للخادم
- **حالة الكاش**: يظهر ما إذا كانت البيانات من الكاش أم جديدة
- **آخر تحديث**: يعرض وقت آخر تحديث للبيانات

## 🔐 **الأمان والتكوين**

### **متغيرات البيئة**
`fb-server/.env` يحتوي على:
- `FB_APP_ID`: معرف تطبيق فيسبوك
- `FB_APP_SECRET`: مفتاح تطبيق فيسبوك السري
- `FB_USER_LONG_LIVED_TOKEN`: رمز الوصول طويل المدى
- `CACHE_TTL_SECONDS`: مدة صلاحية الكاش
- `PORT`: منفذ الخادم

## 🌐 **واجهات API المتاحة**

### **الخادم الخلفي يوفر:**
1. **GET /posts** - جلب المنشورات مع خيارات متقدمة
2. **GET /breakdown/:postId** - تفاصيل التفاعلات لمنشور معين
3. **GET /metrics** - إحصائيات الاستخدام
4. **POST /invalidate-cache** - تفريغ الكاش
5. **GET /auth/status** - حالة رمز الوصول
6. **GET /og-image** - جلب صور المعاينة من الروابط

### **تفاصيل API Endpoints:**

#### **GET /posts**
يجلب المنشورات مع خيارات متقدمة:
- `limit`: عدد المنشورات (افتراضي 5، أقصى 100)
- `page_id`: معرف الصفحة (افتراضي 'me')
- `start_date`: تاريخ البداية (ISO format)
- `end_date`: تاريخ النهاية (ISO format)
- `has_image`: فلترة بالصور (true/false)
- `sort_by`: ترتيب حسب (reactions/comments/created_time)
- `top`: عرض الأفضل فقط (true/false)
- `collect`: وضع الجمع عبر صفحات متعددة (true/false)
- `desired`: العدد المطلوب في وضع الجمع
- `max_pages`: أقصى عدد صفحات للجمع

#### **GET /breakdown/:postId**
يجلب تفاصيل التفاعلات لمنشور معين:
- يعرض عدد كل نوع تفاعل (LIKE, LOVE, HAHA, WOW, SAD, ANGRY, CARE)
- يستخدم Facebook Batch API لتحسين الأداء

## 🎨 **التصميم والواجهة**

- تصميم حديث ومتجاوب
- استخدام CSS Grid لعرض المنشورات
- ألوان هادئة ومريحة للعين
- أيقونات تعبيرية للتفاعلات
- رسائل تنبيه وحالات التحميل

### **مكونات الواجهة:**
- **Header**: يحتوي على العنوان وأزرار التحكم
- **Controls Panel**: أزرار التحميل والتحديث التلقائي
- **Filters Panel**: خيارات الفلترة والترتيب
- **Metrics Bar**: عرض إحصائيات الاستخدام
- **Posts Grid**: شبكة عرض المنشورات
- **Post Cards**: بطاقات المنشورات مع الصور والتفاعلات

## 🚀 **كيفية التشغيل**

### **1. تشغيل الخادم الخلفي:**
```bash
cd fb-server
npm install
npm start
```

### **2. تشغيل الواجهة الأمامية:**
```bash
npm install
npm run dev
```

### **3. الوصول للتطبيق:**
- **الواجهة الأمامية**: http://localhost:5173
- **الخادم الخلفي**: http://localhost:4000

## 📁 **هيكل الملفات**

```
fb-posts/
├── .env.local                 # متغيرات بيئة الواجهة
├── .gitignore                 # ملفات مستبعدة من Git
├── README.md                  # وصف المشروع
├── package.json               # تبعيات الواجهة
├── vite.config.js            # إعدادات Vite
├── index.html                # ملف HTML الرئيسي
├── src/
│   ├── App.jsx               # المكون الرئيسي
│   ├── main.jsx              # نقطة الدخول
│   ├── index.css             # الأنماط الرئيسية
│   └── App.css               # أنماط إضافية
├── fb-server/
│   ├── .env                  # متغيرات بيئة الخادم
│   ├── .env.example          # مثال لمتغيرات البيئة
│   ├── package.json          # تبعيات الخادم
│   └── server.cjs            # الخادم الرئيسي
└── public/
    └── vite.svg              # أيقونة Vite
```

## 💡 **نقاط القوة**

- **كفاءة في استهلاك API**: نظام كاش متطور يقلل الطلبات
- **مرونة في البحث**: خيارات فلترة وترتيب متنوعة
- **واجهة سهلة الاستخدام**: تصميم بديهي ومتجاوب
- **مراقبة الأداء**: نظام metrics شامل
- **أمان البيانات**: حماية المفاتيح في متغيرات البيئة
- **تحديث تلقائي**: إمكانية تحديث البيانات دورياً
- **دعم الصور**: عرض صور المنشورات وصور المعاينة

## 🔧 **التحسينات المستقبلية**

- إضافة قاعدة بيانات للتخزين الدائم
- دعم المزيد من أنواع المحتوى (فيديوهات، روابط)
- إضافة تحليلات أكثر تفصيلاً
- دعم صفحات فيسبوك متعددة
- إضافة نظام تنبيهات للمنشورات الجديدة
- تحسين الأداء للمنشورات الكثيرة

## 🛠️ **التبعيات المستخدمة**

### **الواجهة الأمامية:**
- React 19.1.1
- Vite 7.1.7
- ESLint للتحقق من الكود

### **الخادم الخلفي:**
- Express.js 5.1.0
- Axios 1.12.2 (لطلبات HTTP)
- Cheerio 1.1.2 (لتحليل HTML)
- Node-Cache 5.1.2 (للتخزين المؤقت)
- CORS 2.8.5 (لدعم الطلبات المتقاطعة)
- Dotenv 16.4.5 (لمتغيرات البيئة)

هذا المشروع مثالي لإدارة ومراقبة منشورات فيسبوك بطريقة احترافية وفعالة!